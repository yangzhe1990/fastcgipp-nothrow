<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>fastcgi++: transceiver.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">fastcgi++
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8c95d86379560d59b3e85e1cc950819f.html">include</a></li><li class="navelem"><a class="el" href="dir_708537dc6ffc026db074dae4979ce396.html">fastcgi++</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">transceiver.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00112.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">/***************************************************************************</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">* Copyright (C) 2007 Eddie Carle [eddie@erctech.org]                       *</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">*                                                                          *</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">* This file is part of fastcgi++.                                          *</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">*                                                                          *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">* fastcgi++ is free software: you can redistribute it and/or modify it     *</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">* under the terms of the GNU Lesser General Public License as  published   *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">* by the Free Software Foundation, either version 3 of the License, or (at *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">* your option) any later version.                                          *</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">*                                                                          *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">* fastcgi++ is distributed in the hope that it will be useful, but WITHOUT *</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">* ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or    *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">* FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public     *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">* License for more details.                                                *</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">*                                                                          *</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">* You should have received a copy of the GNU Lesser General Public License *</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">* along with fastcgi++.  If not, see &lt;http://www.gnu.org/licenses/&gt;.       *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">****************************************************************************/</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#ifndef TRANSCEIVER_HPP</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#define TRANSCEIVER_HPP</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;list&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;boost/function.hpp&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;boost/bind.hpp&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;boost/shared_array.hpp&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;errno.h&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;poll.h&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;sys/socket.h&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;sys/un.h&gt;</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00107.html" title="Defines FastCGI protocol.">fastcgi++/protocol.hpp</a>&gt;</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="a00096.html" title="Defines fastcgi++ exceptions.">fastcgi++/exceptions.hpp</a>&gt;</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="keyword">namespace </span>Fastcgipp</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="code" href="a00010.html">   56</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="a00010.html" title="A raw block of memory.">Block</a></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;   {</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;</div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="code" href="a00010.html#a22087bb7e25a6ba6b45ccd0a80e23066">   63</a></span>&#160;      <a class="code" href="a00010.html#a22087bb7e25a6ba6b45ccd0a80e23066" title="Construct from a pointer and size.">Block</a>(<span class="keywordtype">char</span>* data_, <span class="keywordtype">size_t</span> size_): <a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>(data_), <a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>(size_) { }</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="code" href="a00010.html#a9226974a6c021b674e1abbb857f752bf">   65</a></span>&#160;      <a class="code" href="a00010.html#a9226974a6c021b674e1abbb857f752bf" title="Copies pointer and size, not data.">Block</a>(<span class="keyword">const</span> <a class="code" href="a00010.html" title="A raw block of memory.">Block</a>&amp; block): <a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>(block.<a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>), <a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>(block.<a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>) { }</div>
<div class="line"><a name="l00067"></a><span class="lineno"><a class="code" href="a00010.html#a90110dbc90ef7f2c6201ce06e625dfd2">   67</a></span>&#160;      <span class="keyword">const</span> <a class="code" href="a00010.html" title="A raw block of memory.">Block</a>&amp; <a class="code" href="a00010.html#a90110dbc90ef7f2c6201ce06e625dfd2" title="Copies pointer and size, not data.">operator=</a>(<span class="keyword">const</span> <a class="code" href="a00010.html" title="A raw block of memory.">Block</a>&amp; block) { <a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>=block.<a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>; <a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>=block.<a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>; <span class="keywordflow">return</span> *<span class="keyword">this</span>; }</div>
<div class="line"><a name="l00069"></a><span class="lineno"><a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3">   69</a></span>&#160;      <span class="keywordtype">char</span>* <a class="code" href="a00010.html#abdc29a44ee3474fe007ac305504bd4b3" title="Pointer to start of memory location.">data</a>;</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822">   71</a></span>&#160;      <span class="keywordtype">size_t</span> <a class="code" href="a00010.html#a7ae19c5d24797e378b8435a9c22a8822" title="Size in bytes of memory location.">size</a>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;   };</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="code" href="a00083.html">   79</a></span>&#160;   <span class="keyword">class </span><a class="code" href="a00083.html" title="Handles low level communication with &quot;the other side&quot;.">Transceiver</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;   {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="a00083.html#af06e586f5a49dd694f2ae98398870721" title="General transceiver handler.">handler</a>();</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno"><a class="code" href="a00083.html#a5019405a5a05d60fdaa73d349cca58c0">   93</a></span>&#160;      <a class="code" href="a00010.html" title="A raw block of memory.">Block</a> <a class="code" href="a00083.html#a5019405a5a05d60fdaa73d349cca58c0" title="Direct interface to Buffer::requestWrite()">requestWrite</a>(<span class="keywordtype">size_t</span> size) { <span class="keywordflow">return</span> <a class="code" href="a00083.html#a8656d4bd7359d7e12a9cc5921fc3a1d4" title="Buffer for transmitting data">buffer</a>.<a class="code" href="a00011.html#acf2cce1c96a7138adda98414f4e0d921" title="Request a write block in the buffer.">requestWrite</a>(size); }</div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="code" href="a00083.html#a1a720bf113ad9781e59b0fc021988d29">   95</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00083.html#a1a720bf113ad9781e59b0fc021988d29" title="Direct interface to Buffer::secureWrite()">secureWrite</a>(<span class="keywordtype">size_t</span> size, <a class="code" href="a00030.html" title="A full ID value for a FastCGI request.">Protocol::FullId</a> <span class="keywordtype">id</span>, <span class="keywordtype">bool</span> kill)  { <a class="code" href="a00083.html#a8656d4bd7359d7e12a9cc5921fc3a1d4" title="Buffer for transmitting data">buffer</a>.<a class="code" href="a00011.html#aa1a80f3feb1355bd5bc57545d16c309e" title="Secure a write in the buffer.">secureWrite</a>(size, <span class="keywordtype">id</span>, kill); <a class="code" href="a00083.html#a54ffa1d25fed65ff61024ff8ce26a99b" title="Transmit all buffered data possible.">transmit</a>(); }</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="a00083.html#ab8be64ba57bcef64d313960544400d6c" title="Constructor.">Transceiver</a>(<span class="keywordtype">int</span> fd_, boost::function&lt;<span class="keywordtype">void</span>(<a class="code" href="a00030.html" title="A full ID value for a FastCGI request.">Protocol::FullId</a>, <a class="code" href="a00041.html" title="Data structure used to pass messages within the fastcgi++ task management system.">Message</a>)&gt; sendMessage_);</div>
<div class="line"><a name="l00106"></a><span class="lineno"><a class="code" href="a00083.html#a5c1bafc977eaa9e4c3e94a5b9eab59eb">  106</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00083.html#a5c1bafc977eaa9e4c3e94a5b9eab59eb" title="Blocks until there is data to receive or a call to wake() is made.">sleep</a>()</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;      {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;         poll(&amp;<a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe" title="poll() file descriptors container">pollFds</a>.front(), <a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe" title="poll() file descriptors container">pollFds</a>.size(), -1);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00083.html#a4dfd5de627b92f6bb5a834a68b20bb85" title="Forces a wakeup from a call to sleep()">wake</a>();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;   <span class="keyword">private</span>:</div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="code" href="a00028.html">  116</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="a00028.html" title="Buffer type for receiving FastCGI records">fdBuffer</a></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      {</div>
<div class="line"><a name="l00119"></a><span class="lineno"><a class="code" href="a00028.html#aabb4c73e67dceac86c5b4f35d50781bf">  119</a></span>&#160;         <a class="code" href="a00031.html" title="Data structure used as the header for FastCGI records.">Protocol::Header</a> <a class="code" href="a00028.html#aabb4c73e67dceac86c5b4f35d50781bf" title="Buffer for header information.">headerBuffer</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="code" href="a00028.html#aa15f4213ca5c0e90ddf167a70ad70cfd">  121</a></span>&#160;         <a class="code" href="a00041.html" title="Data structure used to pass messages within the fastcgi++ task management system.">Message</a> <a class="code" href="a00028.html#aa15f4213ca5c0e90ddf167a70ad70cfd" title="Buffer of complete Message.">messageBuffer</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      };</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="code" href="a00011.html">  135</a></span>&#160;      <span class="keyword">class </span><a class="code" href="a00011.html" title="Buffer type for transmission of FastCGI records">Buffer</a></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      {</div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="code" href="a00029.html">  138</a></span>&#160;         <span class="keyword">struct </span><a class="code" href="a00029.html" title="Frame of data associated with a file descriptor">Frame</a></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;         {</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div>
<div class="line"><a name="l00146"></a><span class="lineno"><a class="code" href="a00029.html#a86bc160b0476082381dae9d15476d8dd">  146</a></span>&#160;            <a class="code" href="a00029.html#a86bc160b0476082381dae9d15476d8dd" title="Constructor.">Frame</a>(<span class="keywordtype">size_t</span> size_, <span class="keywordtype">bool</span> closeFd_, <a class="code" href="a00030.html" title="A full ID value for a FastCGI request.">Protocol::FullId</a> id_): <a class="code" href="a00029.html#ae763a750b6b41fc8ef362cbf037af062" title="Size of the frame.">size</a>(size_), <a class="code" href="a00029.html#a467f45421401b1e384a2d6e4a24eb0c0" title="Boolean value indication whether or not the file descriptor should be closed when the frame has been ...">closeFd</a>(closeFd_), <a class="code" href="a00029.html#ad2947f9ccce71ae2357883cebc4b27ad" title="Complete ID (contains a file descriptor) of associated with the data frame.">id</a>(id_) { }</div>
<div class="line"><a name="l00148"></a><span class="lineno"><a class="code" href="a00029.html#ae763a750b6b41fc8ef362cbf037af062">  148</a></span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="a00029.html#ae763a750b6b41fc8ef362cbf037af062" title="Size of the frame.">size</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="code" href="a00029.html#a467f45421401b1e384a2d6e4a24eb0c0">  150</a></span>&#160;            <span class="keywordtype">bool</span> <a class="code" href="a00029.html#a467f45421401b1e384a2d6e4a24eb0c0" title="Boolean value indication whether or not the file descriptor should be closed when the frame has been ...">closeFd</a>;</div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="code" href="a00029.html#ad2947f9ccce71ae2357883cebc4b27ad">  152</a></span>&#160;            <a class="code" href="a00030.html" title="A full ID value for a FastCGI request.">Protocol::FullId</a> <a class="code" href="a00029.html#ad2947f9ccce71ae2357883cebc4b27ad" title="Complete ID (contains a file descriptor) of associated with the data frame.">id</a>;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;         };</div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b">  155</a></span>&#160;         std::queue&lt;Frame&gt; <a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b" title="Queue of frames waiting to be transmitted.">frames</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="code" href="a00011.html#ae51b5b8802469636725c594f7a826619">  157</a></span>&#160;         <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="a00011.html#ae51b5b8802469636725c594f7a826619" title="Minimum Block size value that can be returned from requestWrite()">minBlockSize</a> = 256;</div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="code" href="a00012.html">  159</a></span>&#160;         <span class="keyword">struct </span><a class="code" href="a00012.html" title="Chunk of data in Buffer">Chunk</a></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;         {</div>
<div class="line"><a name="l00162"></a><span class="lineno"><a class="code" href="a00012.html#a454a1510c92af9c678b5a0f773317259">  162</a></span>&#160;            <span class="keyword">const</span> <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="a00012.html#a454a1510c92af9c678b5a0f773317259" title="Size of data section of the chunk.">size</a> = 131072;</div>
<div class="line"><a name="l00164"></a><span class="lineno"><a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c">  164</a></span>&#160;            boost::shared_array&lt;char&gt; <a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>;</div>
<div class="line"><a name="l00166"></a><span class="lineno"><a class="code" href="a00012.html#a17d175c5415979ca2a95f6c4ac0180fb">  166</a></span>&#160;            <span class="keywordtype">char</span>* <a class="code" href="a00012.html#a17d175c5415979ca2a95f6c4ac0180fb" title="Pointer to the first write byte in the chunk or 1+ the last read byte.">end</a>;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="code" href="a00012.html#a0d19a7134bbb0b3ecbd804e6d767526d">  168</a></span>&#160;            <a class="code" href="a00012.html#a0d19a7134bbb0b3ecbd804e6d767526d" title="Creates a new data chunk.">Chunk</a>(): <a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>(new char[<a class="code" href="a00012.html#a454a1510c92af9c678b5a0f773317259" title="Size of data section of the chunk.">size</a>]), <a class="code" href="a00012.html#a17d175c5415979ca2a95f6c4ac0180fb" title="Pointer to the first write byte in the chunk or 1+ the last read byte.">end</a>(<a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>.get()) { }</div>
<div class="line"><a name="l00169"></a><span class="lineno"><a class="code" href="a00012.html#a3ee2c11b5258b15519c9b1edb8c0ef0a">  169</a></span>&#160;            <a class="code" href="a00012.html#a3ee2c11b5258b15519c9b1edb8c0ef0a">~Chunk</a>() { } </div>
<div class="line"><a name="l00171"></a><span class="lineno"><a class="code" href="a00012.html#a9db4ad7e1e3dbc18052280f067ad1eed">  171</a></span>&#160;            <a class="code" href="a00012.html#a9db4ad7e1e3dbc18052280f067ad1eed" title="Creates a new object that shares the data of the old one.">Chunk</a>(<span class="keyword">const</span> <a class="code" href="a00012.html" title="Chunk of data in Buffer">Chunk</a>&amp; chunk): <a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>(chunk.<a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>), <a class="code" href="a00012.html#a17d175c5415979ca2a95f6c4ac0180fb" title="Pointer to the first write byte in the chunk or 1+ the last read byte.">end</a>(<a class="code" href="a00012.html#a215df54ee25b79180371073f9f218e2c" title="Pointer to the first byte in the chunk data.">data</a>.get()) { } </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         };</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="code" href="a00011.html#a09b6ee7ec4ba7a7872653211ab6c6e6c">  175</a></span>&#160;         std::list&lt;Chunk&gt; <a class="code" href="a00011.html#a09b6ee7ec4ba7a7872653211ab6c6e6c" title="A list of chunks. Can contain from 2-infinity.">chunks</a>;</div>
<div class="line"><a name="l00177"></a><span class="lineno"><a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b">  177</a></span>&#160;         std::list&lt;Chunk&gt;::iterator <a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;</div>
<div class="line"><a name="l00180"></a><span class="lineno"><a class="code" href="a00011.html#aff72ebe5b6fb28ad04277d3d37c9456c">  180</a></span>&#160;         <span class="keywordtype">char</span>* <a class="code" href="a00011.html#aff72ebe5b6fb28ad04277d3d37c9456c" title="Current read spot in the buffer.">pRead</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="code" href="a00011.html#a5513b34f5f9acbefcf1f85caa69c1b5a">  183</a></span>&#160;         std::vector&lt;pollfd&gt;&amp; <a class="code" href="a00011.html#a5513b34f5f9acbefcf1f85caa69c1b5a" title="A reference to Transceiver::pollFds for removing file descriptors when they are closed.">pollFds</a>;</div>
<div class="line"><a name="l00185"></a><span class="lineno"><a class="code" href="a00011.html#af398abf41d5bd7ca3c9cb1b8aecf5609">  185</a></span>&#160;         std::map&lt;int, fdBuffer&gt;&amp; <a class="code" href="a00011.html#af398abf41d5bd7ca3c9cb1b8aecf5609" title="A reference to Transceiver::fdBuffer for deleting buffers upon closing of the file descriptor...">fdBuffers</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno"><a class="code" href="a00011.html#aa0ab0da239c1f7e919d95292284e2074">  187</a></span>&#160;         <span class="keywordtype">void</span> <a class="code" href="a00011.html#aa0ab0da239c1f7e919d95292284e2074" title="Helper function for freeFd(int fd, std::vector&lt;pollfd&gt; pollFds, std::map&lt;int, fdBuffer&gt; fdBuffers)...">freeFd</a>(<span class="keywordtype">int</span> fd_) { <a class="code" href="a00011.html#aa0ab0da239c1f7e919d95292284e2074" title="Helper function for freeFd(int fd, std::vector&lt;pollfd&gt; pollFds, std::map&lt;int, fdBuffer&gt; fdBuffers)...">Fastcgipp::Transceiver::freeFd</a>(fd_, <a class="code" href="a00011.html#a5513b34f5f9acbefcf1f85caa69c1b5a" title="A reference to Transceiver::pollFds for removing file descriptors when they are closed.">pollFds</a>, <a class="code" href="a00011.html#af398abf41d5bd7ca3c9cb1b8aecf5609" title="A reference to Transceiver::fdBuffer for deleting buffers upon closing of the file descriptor...">fdBuffers</a>);  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">public</span>:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div>
<div class="line"><a name="l00194"></a><span class="lineno"><a class="code" href="a00011.html#ada3b50a0b0605ba275d9eab8477bfb06">  194</a></span>&#160;         <a class="code" href="a00011.html#ada3b50a0b0605ba275d9eab8477bfb06" title="Constructor.">Buffer</a>(std::vector&lt;pollfd&gt;&amp; pollFds_, std::map&lt;int, fdBuffer&gt;&amp; fdBuffers_): <a class="code" href="a00011.html#a09b6ee7ec4ba7a7872653211ab6c6e6c" title="A list of chunks. Can contain from 2-infinity.">chunks</a>(1), <a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>(<a class="code" href="a00011.html#a09b6ee7ec4ba7a7872653211ab6c6e6c" title="A list of chunks. Can contain from 2-infinity.">chunks</a>.begin()), <a class="code" href="a00011.html#aff72ebe5b6fb28ad04277d3d37c9456c" title="Current read spot in the buffer.">pRead</a>(<a class="code" href="a00011.html#a09b6ee7ec4ba7a7872653211ab6c6e6c" title="A list of chunks. Can contain from 2-infinity.">chunks</a>.begin()-&gt;data.get()), <a class="code" href="a00011.html#a5513b34f5f9acbefcf1f85caa69c1b5a" title="A reference to Transceiver::pollFds for removing file descriptors when they are closed.">pollFds</a>(pollFds_), <a class="code" href="a00011.html#af398abf41d5bd7ca3c9cb1b8aecf5609" title="A reference to Transceiver::fdBuffer for deleting buffers upon closing of the file descriptor...">fdBuffers</a>(fdBuffers_)  { }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div>
<div class="line"><a name="l00201"></a><span class="lineno"><a class="code" href="a00011.html#acf2cce1c96a7138adda98414f4e0d921">  201</a></span>&#160;         <a class="code" href="a00010.html" title="A raw block of memory.">Block</a> <a class="code" href="a00011.html#acf2cce1c96a7138adda98414f4e0d921" title="Request a write block in the buffer.">requestWrite</a>(<span class="keywordtype">size_t</span> size)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00010.html" title="A raw block of memory.">Block</a>(<a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>-&gt;end, std::min(size, (<span class="keywordtype">size_t</span>)(<a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>-&gt;data.get()+<a class="code" href="a00012.html#a454a1510c92af9c678b5a0f773317259" title="Size of data section of the chunk.">Chunk::size</a>-<a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>-&gt;end)));</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;         <span class="keywordtype">void</span> <a class="code" href="a00011.html#aa1a80f3feb1355bd5bc57545d16c309e" title="Secure a write in the buffer.">secureWrite</a>(<span class="keywordtype">size_t</span> size, <a class="code" href="a00030.html" title="A full ID value for a FastCGI request.">Protocol::FullId</a> <span class="keywordtype">id</span>, <span class="keywordtype">bool</span> kill);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="code" href="a00061.html">  214</a></span>&#160;         <span class="keyword">struct </span><a class="code" href="a00061.html" title="Block of memory for extraction from Buffer">SendBlock</a></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;         {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div>
<div class="line"><a name="l00222"></a><span class="lineno"><a class="code" href="a00061.html#ad21c4df63e909b3d5ab23059b9268981">  222</a></span>&#160;            <a class="code" href="a00061.html#ad21c4df63e909b3d5ab23059b9268981" title="Constructor.">SendBlock</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* data_, <span class="keywordtype">size_t</span> size_, <span class="keywordtype">int</span> fd_): <a class="code" href="a00061.html#a5253398ffb776cfa9cb1fcac013f597b" title="Pointer to the first byte in the block.">data</a>(data_), <a class="code" href="a00061.html#a87860ac5113f48c42d1b73c121b1c0b5" title="Size in bytes of the data.">size</a>(size_), <a class="code" href="a00061.html#a892d72ea6a897c2a0f4fa364999ef1c1" title="File descriptor the data should be written to.">fd</a>(fd_) { }</div>
<div class="line"><a name="l00224"></a><span class="lineno"><a class="code" href="a00061.html#affab5808ec21d9f6de04cc7b490e39c1">  224</a></span>&#160;            <a class="code" href="a00061.html#affab5808ec21d9f6de04cc7b490e39c1" title="Create a new object that shares the data of the old.">SendBlock</a>(<span class="keyword">const</span> <a class="code" href="a00061.html" title="Block of memory for extraction from Buffer">SendBlock</a>&amp; sendBlock): <a class="code" href="a00061.html#a5253398ffb776cfa9cb1fcac013f597b" title="Pointer to the first byte in the block.">data</a>(sendBlock.<a class="code" href="a00061.html#a5253398ffb776cfa9cb1fcac013f597b" title="Pointer to the first byte in the block.">data</a>), <a class="code" href="a00061.html#a87860ac5113f48c42d1b73c121b1c0b5" title="Size in bytes of the data.">size</a>(sendBlock.<a class="code" href="a00061.html#a87860ac5113f48c42d1b73c121b1c0b5" title="Size in bytes of the data.">size</a>), <a class="code" href="a00061.html#a892d72ea6a897c2a0f4fa364999ef1c1" title="File descriptor the data should be written to.">fd</a>(sendBlock.<a class="code" href="a00061.html#a892d72ea6a897c2a0f4fa364999ef1c1" title="File descriptor the data should be written to.">fd</a>) { }</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="code" href="a00061.html#a5253398ffb776cfa9cb1fcac013f597b">  226</a></span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="a00061.html#a5253398ffb776cfa9cb1fcac013f597b" title="Pointer to the first byte in the block.">data</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno"><a class="code" href="a00061.html#a87860ac5113f48c42d1b73c121b1c0b5">  228</a></span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="a00061.html#a87860ac5113f48c42d1b73c121b1c0b5" title="Size in bytes of the data.">size</a>;</div>
<div class="line"><a name="l00230"></a><span class="lineno"><a class="code" href="a00061.html#a892d72ea6a897c2a0f4fa364999ef1c1">  230</a></span>&#160;            <span class="keywordtype">int</span> <a class="code" href="a00061.html#a892d72ea6a897c2a0f4fa364999ef1c1" title="File descriptor the data should be written to.">fd</a>;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;         };</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;</div>
<div class="line"><a name="l00237"></a><span class="lineno"><a class="code" href="a00011.html#ac017d6e4d7b8552a8c637da676ce7402">  237</a></span>&#160;         <a class="code" href="a00061.html" title="Block of memory for extraction from Buffer">SendBlock</a> <a class="code" href="a00011.html#ac017d6e4d7b8552a8c637da676ce7402" title="Request a block of data for transmitting.">requestRead</a>()</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;         {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00061.html" title="Block of memory for extraction from Buffer">SendBlock</a>(<a class="code" href="a00011.html#aff72ebe5b6fb28ad04277d3d37c9456c" title="Current read spot in the buffer.">pRead</a>, <a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b" title="Queue of frames waiting to be transmitted.">frames</a>.empty()?0:<a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b" title="Queue of frames waiting to be transmitted.">frames</a>.front().size, <a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b" title="Queue of frames waiting to be transmitted.">frames</a>.empty()?-1:<a class="code" href="a00011.html#a638c0333fd0b2f98e705ce3642e9a75b" title="Queue of frames waiting to be transmitted.">frames</a>.front().id.fd);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;         }</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;         <span class="keywordtype">void</span> <a class="code" href="a00011.html#aca9630cbe4c0c08d009fbeed5bd85e92" title="Mark data in the buffer as transmitted and free it&#39;s memory.">freeRead</a>(<span class="keywordtype">size_t</span> size);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00251"></a><span class="lineno"><a class="code" href="a00011.html#af3f403dd53cad518f8cc12d03ac67bd2">  251</a></span>&#160;         <span class="keywordtype">bool</span> <a class="code" href="a00011.html#af3f403dd53cad518f8cc12d03ac67bd2" title="Test of the buffer is empty.">empty</a>()</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;         {</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00011.html#aff72ebe5b6fb28ad04277d3d37c9456c" title="Current read spot in the buffer.">pRead</a>==<a class="code" href="a00011.html#a49fed2468b7b77194943f2b3ece6e12b" title="Iterator pointing to the chunk currently used for writing.">writeIt</a>-&gt;end;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;         }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      };</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="code" href="a00083.html#a8656d4bd7359d7e12a9cc5921fc3a1d4">  258</a></span>&#160;      <a class="code" href="a00011.html" title="Buffer type for transmission of FastCGI records">Buffer</a> <a class="code" href="a00083.html#a8656d4bd7359d7e12a9cc5921fc3a1d4" title="Buffer for transmitting data">buffer</a>;</div>
<div class="line"><a name="l00260"></a><span class="lineno"><a class="code" href="a00083.html#acc1090414ba4805db330e09a3f26178e">  260</a></span>&#160;      boost::function&lt;void(Protocol::FullId, Message)&gt; <a class="code" href="a00083.html#acc1090414ba4805db330e09a3f26178e" title="Function to call to pass messages to requests.">sendMessage</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      </div>
<div class="line"><a name="l00263"></a><span class="lineno"><a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe">  263</a></span>&#160;      std::vector&lt;pollfd&gt; <a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe" title="poll() file descriptors container">pollFds</a>;</div>
<div class="line"><a name="l00265"></a><span class="lineno"><a class="code" href="a00083.html#a19c7caeb43236b6c68f38d04e4bfca33">  265</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="a00083.html#a19c7caeb43236b6c68f38d04e4bfca33" title="Socket to listen for connections on.">socket</a>;</div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="code" href="a00083.html#a7b7f39053271cd4afd41b4672d7eeec4">  267</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="a00083.html#a7b7f39053271cd4afd41b4672d7eeec4" title="Input file descriptor to the wakeup socket pair.">wakeUpFdIn</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno"><a class="code" href="a00083.html#aba0fbaf4469c1c7e36d75a4faade3b7e">  269</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="a00083.html#aba0fbaf4469c1c7e36d75a4faade3b7e" title="Output file descriptor to the wakeup socket pair.">wakeUpFdOut</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      </div>
<div class="line"><a name="l00272"></a><span class="lineno"><a class="code" href="a00083.html#a28c9ac40d0fe11414bc86ad2b8ce4953">  272</a></span>&#160;      std::map&lt;int, fdBuffer&gt; <a class="code" href="a00083.html#a28c9ac40d0fe11414bc86ad2b8ce4953" title="Container associating file descriptors with their receive buffers.">fdBuffers</a>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="a00083.html#a54ffa1d25fed65ff61024ff8ce26a99b" title="Transmit all buffered data possible.">transmit</a>();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;   <span class="keyword">public</span>:</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="a00083.html#a4bd67bf98a35ee4ce178b76e4f77ad4b" title="Free fd/pipe and all it&#39;s associated resources.">freeFd</a>(<span class="keywordtype">int</span> fd, std::vector&lt;pollfd&gt;&amp; <a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe" title="poll() file descriptors container">pollFds</a>, std::map&lt;int, fdBuffer&gt;&amp; <a class="code" href="a00083.html#a28c9ac40d0fe11414bc86ad2b8ce4953" title="Container associating file descriptors with their receive buffers.">fdBuffers</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="code" href="a00083.html#a0c9d8292e0cd5ca9bb454755aed4051b">  292</a></span>&#160;      <span class="keywordtype">void</span> <a class="code" href="a00083.html#a0c9d8292e0cd5ca9bb454755aed4051b" title="Helper function for freeFd(int fd, std::vector&lt;pollfd&gt; pollFds, std::map&lt;int, fdBuffer&gt; fdBuffers)...">freeFd</a>(<span class="keywordtype">int</span> fd_) { <a class="code" href="a00083.html#a0c9d8292e0cd5ca9bb454755aed4051b" title="Helper function for freeFd(int fd, std::vector&lt;pollfd&gt; pollFds, std::map&lt;int, fdBuffer&gt; fdBuffers)...">freeFd</a>(fd_, <a class="code" href="a00083.html#a4b163da2ea08d648a34f9903b86d82fe" title="poll() file descriptors container">pollFds</a>, <a class="code" href="a00083.html#a28c9ac40d0fe11414bc86ad2b8ce4953" title="Container associating file descriptors with their receive buffers.">fdBuffers</a>);  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;   };</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;   </div>
<div class="line"><a name="l00296"></a><span class="lineno"><a class="code" href="a00023.html">  296</a></span>&#160;   <span class="keyword">struct </span><a class="code" href="a00023.html" title="Predicate for comparing the file descriptor of a pollfd.">equalsFd</a> : <span class="keyword">public</span> std::unary_function&lt;pollfd, bool&gt;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   {</div>
<div class="line"><a name="l00298"></a><span class="lineno"><a class="code" href="a00023.html#a03c4e66a736eb9b1cebed2a83e15a637">  298</a></span>&#160;      <span class="keywordtype">int</span> <a class="code" href="a00023.html#a03c4e66a736eb9b1cebed2a83e15a637">fd</a>;</div>
<div class="line"><a name="l00299"></a><span class="lineno"><a class="code" href="a00023.html#a848f55ab00a5feedf1988c7ccc180be3">  299</a></span>&#160;      <span class="keyword">explicit</span> <a class="code" href="a00023.html#a848f55ab00a5feedf1988c7ccc180be3">equalsFd</a>(<span class="keywordtype">int</span> fd_): <a class="code" href="a00023.html#a03c4e66a736eb9b1cebed2a83e15a637">fd</a>(fd_) {}</div>
<div class="line"><a name="l00300"></a><span class="lineno"><a class="code" href="a00023.html#af6c0071d8f8aca29c9c94deda3a064e8">  300</a></span>&#160;      <span class="keywordtype">bool</span> <a class="code" href="a00023.html#af6c0071d8f8aca29c9c94deda3a064e8">operator()</a>(<span class="keyword">const</span> pollfd&amp; x)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> x.fd==<a class="code" href="a00023.html#a03c4e66a736eb9b1cebed2a83e15a637">fd</a>; };</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   };</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;   </div>
<div class="line"><a name="l00304"></a><span class="lineno"><a class="code" href="a00118.html#ab81025146f21643e6e765612d5d57462">  304</a></span>&#160;   <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="a00118.html#ab81025146f21643e6e765612d5d57462" title="Predicate for testing if the revents in a pollfd is non-zero.">reventsZero</a>(<span class="keyword">const</span> pollfd&amp; x)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;   {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="keywordflow">return</span> x.revents;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;   }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;   <span class="keyword">namespace </span>Exceptions</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;   {</div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="code" href="a00072.html">  312</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="a00072.html" title="General exception for socket related errors.">Socket</a>: <span class="keyword">public</span> <a class="code" href="a00014.html" title="General exception class for container errnos and messages.">CodedException</a></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      {</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div>
<div class="line"><a name="l00319"></a><span class="lineno"><a class="code" href="a00072.html#a63720dd5f4d906c6874ffc9905fa73d7">  319</a></span>&#160;         <a class="code" href="a00072.html#a63720dd5f4d906c6874ffc9905fa73d7" title="Sole Constructor.">Socket</a>(<span class="keyword">const</span> <span class="keywordtype">int</span>&amp; fd_, <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; erno_): <a class="code" href="a00014.html" title="General exception class for container errnos and messages.">CodedException</a>(0, erno_), <a class="code" href="a00072.html#a1f620f02bc8438554813bc9228992482" title="File descriptor of socket.">fd</a>(fd_) { }</div>
<div class="line"><a name="l00321"></a><span class="lineno"><a class="code" href="a00072.html#a1f620f02bc8438554813bc9228992482">  321</a></span>&#160;         <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="a00072.html#a1f620f02bc8438554813bc9228992482" title="File descriptor of socket.">fd</a>;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      };</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      </div>
<div class="line"><a name="l00325"></a><span class="lineno"><a class="code" href="a00075.html">  325</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="a00075.html" title="Exception for write errors to sockets">SocketWrite</a>: <span class="keyword">public</span> <a class="code" href="a00072.html" title="General exception for socket related errors.">Socket</a></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;         <a class="code" href="a00075.html#a504556689fd04525e88db4be17863bda" title="Sole Constructor.">SocketWrite</a>(<span class="keywordtype">int</span> fd_, <span class="keywordtype">int</span> erno_);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      };</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      </div>
<div class="line"><a name="l00336"></a><span class="lineno"><a class="code" href="a00074.html">  336</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="a00074.html" title="Exception for read errors to sockets">SocketRead</a>: <span class="keyword">public</span> <a class="code" href="a00072.html" title="General exception for socket related errors.">Socket</a></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;         <a class="code" href="a00074.html#a7d1bdda3376e37c47cd98735171ab513" title="Sole Constructor.">SocketRead</a>(<span class="keywordtype">int</span> fd_, <span class="keywordtype">int</span> erno_);</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      };</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      </div>
<div class="line"><a name="l00347"></a><span class="lineno"><a class="code" href="a00073.html">  347</a></span>&#160;      <span class="keyword">struct </span><a class="code" href="a00073.html" title="Exception for poll() errors">SocketPoll</a>: <span class="keyword">public</span> <a class="code" href="a00014.html" title="General exception class for container errnos and messages.">CodedException</a></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;         <a class="code" href="a00073.html#a00a748cfe698183e32990da239e6b36c" title="Sole Constructor.">SocketPoll</a>(<span class="keywordtype">int</span> erno_);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      };</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Aug 22 2012 20:35:53 for fastcgi++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.1
</small></address>
</body>
</html>
